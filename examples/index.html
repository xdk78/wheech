<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>basic</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="../dist/wheech.umd.js"></script>
</head>

<body>
  <canvas id="game"></canvas>
  <script>
    // WIP THIS IS MOCK CURRENTLY
    const w = new wheech.Wheech()

    const game = w.createGame('game', { width: 800, height: 600 })
    const physics = new wheech.Physics()
    const subjectus = new wheech.InputSubject(document)

    const rectBody = new wheech.RectangleBody({ x: 50, y: 50 }, 50, 50, { fillStyle: 'palevioletred' })
    const rect = new wheech.Sprite()
    rect.setShape(rectBody)

    const groundBody = new wheech.RectangleBody({ x: 10, y: 200 }, 500, 50, { fillStyle: 'red' }, { isStatic: true })
    const ground = new wheech.Sprite()
    ground.setShape(groundBody)

    wheech.Matter.Events.on(physics.engine, 'collisionStart', (event) => {
      console.log(event)
    })

    let rect2x = 5
    let rect2y = 5
    const rectShape2 = new wheech.RectangleShape({ x: rect2x, y: rect2x }, 50, 50, { fillStyle: 'purple' })
    const rect2 = new wheech.Sprite()
    
    subjectus.keydownSubject.subscribe((event) => {
      if (event == wheech.KeyCodes.ARROW_RIGHT) {
        console.log('ARROW_RIGHT')
        rect2x += 10
      }
      else if (event == wheech.KeyCodes.ARROW_LEFT) {
        console.log('ARROW_LEFT')
        rect2x -= 10
      }
      else if (event == wheech.KeyCodes.ARROW_UP) {
        console.log('ARROW_UP')
        rect2y -= 10
      }
      else if (event == wheech.KeyCodes.ARROW_DOWN) {
        console.log('ARROW_DOWN')
        rect2y += 10
      }
      rectShape2.setPosition({ x: rect2x, y: rect2y })
    })
    rect2.setShape(rectShape2)

    physics.addBody(rectBody.getBody())
    physics.addBody(groundBody.getBody())

    const scene = new wheech.Scene('blue', physics, [rect, rect2, ground])
    game.setCurrentScene(scene)
    game.run()

  </script>
</body>

</html>